<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">






  <link rel="canonical" href="http://yoursite.com/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Hexo</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Startseite</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archiv</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/04/HDFSArchitecture/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/04/HDFSArchitecture/" itemprop="url">
                  HDFS Architecture(HDFS 架构)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2018-07-04 18:38:42" itemprop="dateCreated datePublished" datetime="2018-07-04T18:38:42+08:00">2018-07-04</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://paxbdafi7.bkt.clouddn.com/HDFSArchitecture.png" alt="HDFS Architecture"></p>
<ul>
<li>HDFS有一个主/从架构，一个HDFS集群由一个单一的NameNode，它是管理文件系统命名空间的主服务器，并管理客户对文件的访问。NameNode执行文件系统命名空间操作，如打开，关闭和重命名文件和目录。它还确定块到DataNode的映射关系。</li>
<li>此外，还有许多的DataNode(通常每个节点一个)，它们管理所在的节点的数据存储。DataNodes负责处理来自Clients的读写请求。同时再NameNode的指令下执行Block的创建，删除，复制。</li>
<li><p>HDFS 公开一个命名空间，允许用户数据存储再文件中。再内部文件被分割成一个或者多个数据块，这些数据块存储再DataNode集群中。</p>
</li>
<li><p>典型的HDFS集群，会有一个专用的机器来运行NameNode，其他机器都运行一个DataNode实例。</p>
</li>
</ul>
<p>Note: 集群中单个NameNode的存在极大地简化了系统的架构，NameNode是所有HDFS元数据的仲裁器和存储库。用户的数据是永远不会通过NameNode。</p>
<h3 id="文件系统命名空间"><a href="#文件系统命名空间" class="headerlink" title="文件系统命名空间"></a>文件系统命名空间</h3><ul>
<li>HDFS的文件系统类似于传统的分层结构，用户同样可以创建目录并且在目录下创建文件、删除文件，移动文件或者重命名文件. HDFS2.6.5目前还不支持对用户进行分配额度或者访问权限，以及文件间的软硬链接。未来可能会有这种功能。</li>
<li>NameNode维护文件系统命名空间，对其的任何更改都会进行记录。</li>
<li>可以指定一个文件的副本数量。一般为3份。 文件的拷贝数称为文件的复制因子。可以由参数指定。</li>
</ul>
<h1 id="数据复制-Data-Replication"><a href="#数据复制-Data-Replication" class="headerlink" title="数据复制(Data Replication)"></a>数据复制(Data Replication)</h1><p>HDFS在集群中存储大文件，将每个文件存储为快序列。一个文件的所有的块除了最后一个block 其他的block 都是一样的大小。<br>每个文件的复制因子(备份) 的数量是可以指定的。</p>
<p><img src="http://paxbdafi7.bkt.clouddn.com/HDFSDataReplication.png" alt="Data Replication"></p>
<h2 id="副本放置策略"><a href="#副本放置策略" class="headerlink" title="副本放置策略"></a>副本放置策略</h2><p>HDFS的数据复制对提高其可靠性和性能至关重要。</p>
<h3 id="机架感知策略"><a href="#机架感知策略" class="headerlink" title="机架感知策略"></a>机架感知策略</h3><ul>
<li>比如副本数量指定为3时。 HDFS的放置策略是将一个副本放在本地机架的一个node上，另一个副本放在本地机架的另一个node上。最后一个副本放在另一个机架的另一个节点上。</li>
<li>这种策略减少了机架间的写流量，提高写性能。机架间的故障概率远小于节点故障的概率。这个策略，文件的副本就不会均匀分布再各个机架上。三分之一的副本再一个节点上，三分之二的副本再一个架子上，另外三分之一均匀分布在剩下的架子上。</li>
<li>这种策略改进了写性能，而不影响数据可靠性或读性能。</li>
</ul>
<h2 id="副本选择"><a href="#副本选择" class="headerlink" title="副本选择"></a>副本选择</h2><ul>
<li>为了最小化带宽消耗和读取延迟，在一个读取请求过来的时候，如果在读取节点所在机架上存在一个请求的副本，那么这个副本更适合提供读取请求。</li>
</ul>
<h2 id="安全模式"><a href="#安全模式" class="headerlink" title="安全模式"></a>安全模式</h2><ul>
<li>在集群启动的时候，NameNode会进入一种Safemode(安全模式)的特殊状态。这时候是不会发生数据库复制的。只有当NameNode接收到DataNodes的心跳和block report后。 Block报告包含DataNodes管理的所有的数据块的列表。NameNode会检查数据块的最小复制数、在检查数据快复制百分比之后。退出安全模式。</li>
<li>这时候确定仍然少于指定的副本数量。NameNode 会将这些块按照对应的策略复制到其他的DataNode。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/26/Spark-Env-Conf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/26/Spark-Env-Conf/" itemprop="url">
                  Spark安装配置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2018-06-26 16:36:41 / Updated at: 17:26:59" itemprop="dateCreated datePublished" datetime="2018-06-26T16:36:41+08:00">2018-06-26</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Spark-On-Yarn"><a href="#Spark-On-Yarn" class="headerlink" title="Spark On Yarn"></a>Spark On Yarn</h1><h3 id="安装环境"><a href="#安装环境" class="headerlink" title="安装环境"></a>安装环境</h3><ul>
<li>yarn: hadoop-2.6.1 </li>
<li>hive:apache-hive-1.2.2-bin </li>
<li>spark:spark-2.0.2-bin-hadoop2.6</li>
<li>scala:scala-2.11.8</li>
</ul>
<h3 id="Yarn-集群"><a href="#Yarn-集群" class="headerlink" title="Yarn 集群"></a>Yarn 集群</h3><ul>
<li>master:192.168.146.129</li>
<li>slave1:192.168.146.130</li>
<li>slave2:192.168.146.131</li>
<li>SSH信任已经配置成功</li>
</ul>
<h3 id="获取安装包"><a href="#获取安装包" class="headerlink" title="获取安装包"></a>获取安装包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://mirror.bit.edu.cn/apache/spark/spark-2.0.2/spark-2.0.2-bin-hadoop2.6.tgz</span><br></pre></td></tr></table></figure>
<p>或者自己上传</p>
<h4 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@master src]# ll *.tgz       </span><br><span class="line">-rw-r--r--. 1 root root  28678231 Jun  8 19:40 scala-2.11.8.tgz</span><br><span class="line">-rw-r--r--. 1 root root 185040619 Jun  8 19:41 spark-2.0.2-bin-hadoop2.6.tgz</span><br><span class="line">[root@master src]# pwd</span><br><span class="line">/usr/local/src</span><br><span class="line">[root@master src]# tar -xvzf spark-2.0.2-bin-hadoop2.6.tgz</span><br></pre></td></tr></table></figure>
<h3 id="修改配置信息"><a href="#修改配置信息" class="headerlink" title="修改配置信息"></a>修改配置信息</h3><h4 id="编辑-Spark-env-sh"><a href="#编辑-Spark-env-sh" class="headerlink" title="编辑 Spark-env.sh"></a>编辑 Spark-env.sh</h4><p>添加<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">export SCALA_HOME=/usr/local/src/scala-2.11.8</span><br><span class="line">export JAVA_HOME=/usr/local/src/jdk1.7.0_67</span><br><span class="line">export HADOOP_HOME=/usr/local/src/hadoop-2.6.1</span><br><span class="line">export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop</span><br><span class="line">export SPARK_LOCAL_DIRS=/usr/local/src/spark-2.0.2-bin-hadoop2.6</span><br><span class="line">export SPARK_MASTER_IP=master</span><br><span class="line">export SPARK_DRIVER_MEMORY=2G</span><br></pre></td></tr></table></figure></p>
<h4 id="编辑-slaves"><a href="#编辑-slaves" class="headerlink" title="编辑 slaves"></a>编辑 slaves</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@master conf]# cp slaves.template slaves</span><br><span class="line">[root@master conf]# vim slaves</span><br><span class="line"><span class="meta">#</span><span class="bash"> A Spark Worker will be started on each of the machines listed below.</span></span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure>
<h3 id="将配置好的spark安装目录，分发到slave1-2-节点上。"><a href="#将配置好的spark安装目录，分发到slave1-2-节点上。" class="headerlink" title="将配置好的spark安装目录，分发到slave1/2 节点上。"></a>将配置好的spark安装目录，分发到slave1/2 节点上。</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master bin]# scp -r  spark-2.0.2-bin-hadoop2.6  root@slave1:/usr/local/src/</span><br><span class="line">[root@master bin]# scp -r  spark-2.0.2-bin-hadoop2.6  root@slave2:/usr/local/src/</span><br></pre></td></tr></table></figure>
<h3 id="启动spark进程"><a href="#启动spark进程" class="headerlink" title="启动spark进程"></a>启动spark进程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@master spark-2.0.2-bin-hadoop2.6]# ./sbin/start-all.sh </span><br><span class="line">starting org.apache.spark.deploy.master.Master, logging to /usr/local/src/spark-2.0.2-bin-hadoop2.6/logs/spark-root-org.apache.spark.deploy.master.Master-1-master.out</span><br><span class="line">slave2: starting org.apache.spark.deploy.worker.Worker, logging to /usr/local/src/spark-2.0.2-bin-hadoop2.6/logs/spark-root-org.apache.spark.deploy.worker.Worker-1-slave2.out</span><br><span class="line">slave1: starting org.apache.spark.deploy.worker.Worker, logging to /usr/local/src/spark-2.0.2-bin-hadoop2.6/logs/spark-root-org.apache.spark.deploy.worker.Worker-1-slave1.out</span><br><span class="line">[root@master spark-2.0.2-bin-hadoop2.6]# jps</span><br><span class="line">10989 Jps</span><br><span class="line">10920 Master</span><br><span class="line">2694 SecondaryNameNode</span><br><span class="line">2551 NameNode</span><br><span class="line">2843 ResourceManager</span><br></pre></td></tr></table></figure>
<h3 id="启动spark-shell"><a href="#启动spark-shell" class="headerlink" title="启动spark-shell"></a>启动spark-shell</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@master spark-2.0.2-bin-hadoop2.6]# ./bin/spark-shell </span><br><span class="line">Setting default log level to "WARN".</span><br><span class="line">To adjust logging level use sc.setLogLevel(newLevel).</span><br><span class="line">18/06/26 00:57:35 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable</span><br><span class="line">18/06/26 00:57:41 WARN spark.SparkContext: Use an existing SparkContext, some configuration may not take effect.</span><br><span class="line">Spark context Web UI available at http://192.168.146.129:4040</span><br><span class="line">Spark context available as 'sc' (master = local[*], app id = local-1529999859799).</span><br><span class="line">Spark session available as 'spark'.</span><br><span class="line">Welcome to</span><br><span class="line">      ____              __</span><br><span class="line">     / __/__  ___ _____/ /__</span><br><span class="line">    _\ \/ _ \/ _ `/ __/  '_/</span><br><span class="line">   /___/ .__/\_,_/_/ /_/\_\   version 2.0.2</span><br><span class="line">      /_/</span><br><span class="line">         </span><br><span class="line">Using Scala version 2.11.8 (Java HotSpot(TM) 64-Bit Server VM, Java 1.7.0_67)</span><br><span class="line">Type in expressions to have them evaluated.</span><br><span class="line">Type :help for more information.</span><br><span class="line"></span><br><span class="line"><span class="meta">scala&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure>
<h3 id="验证spark"><a href="#验证spark" class="headerlink" title="验证spark"></a>验证spark</h3><ul>
<li>本地模式：<br><code>– ]# ./bin/run-example SparkPi 10 --master local[2]</code></li>
<li>集群模式 Spark Standalone：<br><code>– ]# ./bin/spark-submit --class org.apache.spark.examples.SparkPi --master spark://master:7077 examples/jars/spark-examples_2.11-2.0.2.jar 100</code></li>
<li>集群模式 Spark on Yarn集群上yarn-cluster模式：<br><code>– ]# ./bin/spark-submit --class org.apache.spark.examples.SparkPi --master yarn-cluster examples/jars/spark-examples_2.11-2.0.2.jar 10</code><h4 id="验证spark-on-yarn-。"><a href="#验证spark-on-yarn-。" class="headerlink" title="验证spark on yarn 。"></a>验证spark on yarn 。</h4></li>
</ul>
<p><img src="http://paxbdafi7.bkt.clouddn.com/%E5%B0%8F%E4%B9%A6%E5%8C%A0/1530004692394.png" alt="Spark on yarn"></p>
<p><img src="http://paxbdafi7.bkt.clouddn.com/%E5%B0%8F%E4%B9%A6%E5%8C%A0/1530004802928.png" alt="监控页面信息"></p>
<h4 id="配置spark-connect-hive"><a href="#配置spark-connect-hive" class="headerlink" title="配置spark connect hive"></a>配置spark connect hive</h4><p>因为需要在spark里调用sparksql。所以需要spark 访问hive数据。</p>
<ul>
<li><p>需要将hive-site.xml 拷贝到spark 的conf 目录下。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/local/src/apache-hive-1.2.2-bin/conf/hive-site.xml /usr/local/src/spark-2.0.2-bin-hadoop2.6/conf/</span><br></pre></td></tr></table></figure>
</li>
<li><p>将对应的mysql-connector-java-5.1.44-bin.jar 放到$SPARK_HOME/jars/目录下。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/local/src/mysql-connector-java-5.1.41/mysql-connector-java-5.1.41-bin.jar /usr/local/src/spark-2.0.2-bin-hadoop2.6/jars/</span><br></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/25/Refreshing Materialized View/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/25/Refreshing Materialized View/" itemprop="url">
                  Refreshing Materialized View
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2018-06-25 14:57:21" itemprop="dateCreated datePublished" datetime="2018-06-25T14:57:21+08:00">2018-06-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Updated at: 2018-07-03 13:33:56" itemprop="dateModified" datetime="2018-07-03T13:33:56+08:00">2018-07-03</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="refer-to"><a href="#refer-to" class="headerlink" title="refer to"></a>refer to</h1><p>Oracle 官方文档 Url : <a href="https://docs.oracle.com/cd/E11882_01/server.112/e25554/refresh.htm#DWHSG03003" target="_blank" rel="noopener">https://docs.oracle.com/cd/E11882_01/server.112/e25554/refresh.htm#DWHSG03003</a></p>
<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>在创建 materialized view 的时候可以指定两种刷新方式</p>
<ul>
<li>ON COMMIT<br>在这种机制下，Materialized view 在每次commit 的时候都会自动 refresh。</li>
<li>ON DEMAND<br>在这中case下，Materialized view 只能通过call DBMS_MVIEW 这个package中的procedure才能进行refresh</li>
</ul>
<p>DBMS_MVIEW 提供3种刷新方式</p>
<ul>
<li>DBMS_MVIEW.REFRESH  # 刷新一个或者多个物化视图</li>
<li>DBMS_MVIEW.REFRESH_ALL_MVIEWS  # 刷新所有的物化视图</li>
<li>DBMS_MVIEW.REFRESH_DEPENDENT  # 刷新所有依赖于指定的主表、物化视图（可以是多个）的物化视图</li>
</ul>
<h4 id="Note"><a href="#Note" class="headerlink" title=" Note: "></a><font color="red" size="6"> Note: </font></h4><ul>
<li>由于刷新物化视图操作需要临时空间来重建索引，并且可能需要额外的空间来执行刷新操作本身，所以不需要频繁的进行刷新操作。因此如果没有及时刷新物化视图的话，需要考虑查询重写的问题。 </li>
<li>可以通过 <code>ALTER SYSTEM SET QUERY_REWRITE_ENABLED = FALSE or TRUE</code> 来禁用或者启用查询重写操作。</li>
<li>Oracle 版本 10 以下 默认为fales ， 10 以上 为TRUE</li>
<li>If you anticipate performing insert, update or delete operations on tables referenced by a materialized view concurrently with the refresh of that materialized view, and that materialized view includes joins and aggregation, Oracle recommends you use ON COMMIT fast refresh rather than ON DEMAND fast refresh.(如果预计在物化视图刷新的同时对物化视图引用的表执行插入，更新或删除操作，并且该物化视图包含连接和聚合，Oracle建议您使用ON COMMIT快速刷新而不是ON DEMAND快速刷新。)</li>
</ul>
<h1 id="Refresh-method-4种"><a href="#Refresh-method-4种" class="headerlink" title="Refresh method (4种)"></a>Refresh method (4种)</h1><h2 id="Complete-Refresh"><a href="#Complete-Refresh" class="headerlink" title="Complete Refresh"></a>Complete Refresh</h2><ul>
<li>build immediate 在物化视图第一次创建的时候会发生完全刷新，除非创建的物化视图引用的表还没有被创建.</li>
<li>build deferred  创建的物化视图，第一时间是不会进行完全刷新，但必须在第一次使用之前进行一次完整的刷新.</li>
<li>刷新过程需要读取细节表，计算物化视图结果，非常耗时，尤其是当需要读取大量数据时。</li>
</ul>
<h2 id="Fast-Refresh"><a href="#Fast-Refresh" class="headerlink" title="Fast Refresh"></a>Fast Refresh</h2><ul>
<li>对比上面的完整刷新，快速刷新物化视图不需要重新计算整个物化视图，而是将更改现有的数据，所以会比较快</li>
</ul>
<h2 id="Partition-Change-Tracking-PCT-Refresh"><a href="#Partition-Change-Tracking-PCT-Refresh" class="headerlink" title="Partition Change Tracking (PCT) Refresh"></a>Partition Change Tracking (PCT) Refresh</h2><ul>
<li>当物化视图引用的表有分区操作的时候，只能使用快速刷新(Fast Refresh) ,但是要满足PCT 的所有条件才允许基于PC的刷新。<br>-对于没有分区的表，如果使用Fast Refresh (method =&gt; ‘F’),Oracle在执行之前会尝试基于log的快速刷新。</li>
<li>类似的当使用Force方法刷新的时候，Oracle 会按如下顺序选择Refresh方式: log-based fast refresh , PCT refresh , complete</li>
<li>当然你也可以指定PCT刷新方式（method =&gt; ‘P’）</li>
</ul>
<h2 id="ON-COMMIT-Refresh"><a href="#ON-COMMIT-Refresh" class="headerlink" title="ON COMMIT Refresh"></a>ON COMMIT Refresh</h2><ul>
<li>使用这种方法自动刷新物化视图，当事物更新了一个物化视图引用的表时，这些changes会自动刷新到对应的物化视图上。</li>
<li>好处是 不需要定时刷新物化视图</li>
<li>缺点 commit 需要的时间比较长。不过如果再数据仓库中应该不是问题，因为不太可能并发进程，所以再OLTP中要避免这种MV。</li>
</ul>
<h2 id="Manual-Refresh-Using-The-DBMS-MVIEW-package"><a href="#Manual-Refresh-Using-The-DBMS-MVIEW-package" class="headerlink" title="Manual Refresh Using The DBMS_MVIEW package"></a>Manual Refresh Using The DBMS_MVIEW package</h2><ul>
<li>刷新物化视图时，可以指定4中方法之一，入下图所示</li>
</ul>
<table>
<thead>
<tr>
<th>Refresh Option</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>COMPLETE</td>
<td>C</td>
<td>通过重新计算物化视图定义的查询来刷新</td>
</tr>
<tr>
<td>FAST</td>
<td>F</td>
<td>通过增量地对物化视图应用更改来刷新，对于本地物化视图，它选择由优化器估计的最新方法。所考虑的刷新方法是基于日志的快速和FAST_PCT。</td>
</tr>
<tr>
<td>FAST_PCT</td>
<td>P</td>
<td>通过重新计算在引用的明细表中受到更改的分区影响的物化视图中的行来进行刷新。</td>
</tr>
<tr>
<td>FORCE</td>
<td>F&amp;？</td>
<td>先尝试快速刷新，如果不符合快速刷新条件，就会进行完全刷新。优化器选择的刷新基于日子的FAST ，FAST_PCT 和 COMPLETE</td>
</tr>
</tbody>
</table>
<h1 id="Refresh-procedure-常用的3种"><a href="#Refresh-procedure-常用的3种" class="headerlink" title="Refresh procedure (常用的3种)"></a>Refresh procedure (常用的3种)</h1><h2 id="调用DBMS-MVIEW-REFRESH刷新Materialized-View"><a href="#调用DBMS-MVIEW-REFRESH刷新Materialized-View" class="headerlink" title="调用DBMS_MVIEW.REFRESH刷新Materialized View"></a>调用<code>DBMS_MVIEW.REFRESH</code>刷新Materialized View</h2><ul>
<li>如果多个物化视图一起刷新需要用逗号分割。(list&amp;tab)</li>
<li>刷新方法: F-Fast , P-Fast_PCT , ? - Force , C-Complete (Method)</li>
<li>使用回滚段 (rollback_seg) 默认为 NULL</li>
<li>在错误之后是否进行刷新(TRUE or FALSE)。True: 那么需要将 <code>number_of_failure</code> 设置一个失败以后刷新的次数，类似于重新请求。FALSE: 默认Refresh 在遇到第一个错误的时候就会停止，并且列表剩余的物化视图不会刷新。 （refresh_after_errors） 默认为FALSE</li>
<li>下面的4个参数，用来进行 replication 过程的时候，一般再数据仓库的刷新时候 依次设置为 <code>FALSE,0,0,0</code></li>
<li>Atomic refresh (TRUE or FALSE) atomic_refresh 默认为TRUE  TRUE: 所有的刷新操作在一个事物中完成. FALSE: 在单独的事务中刷新每个指定的物化视图。<h4 id="For-exampl"><a href="#For-exampl" class="headerlink" title="For exampl"></a>For exampl</h4></li>
<li><p>fast refresh  MV : cal_month_sales_mv</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DBMS_MVIEW.REFRESH('CAL_MONTH_SALES_MV', 'F', '', TRUE, FALSE, 0,0,0, FALSE);</span><br></pre></td></tr></table></figure>
</li>
<li><p>多个物化视图刷新:<code>CAL_MONTH_SALES_MV</code> 完全刷新 <code>FWEEK_PSCAT_SALES_MV</code> 快速刷新</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DBMS_MVIEW.REFRESH('CAL_MONTH_SALES_MV, FWEEK_PSCAT_SALES_MV', 'CF', '', </span><br><span class="line"> TRUE, FALSE, 0,0,0, FALSE);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="Note-1"><a href="#Note-1" class="headerlink" title=" Note: "></a><font color="red" size="6"> Note: </font></h4><ul>
<li>如果未指定refresh方法，则使用物化视图定义中指定的默认刷新方法。</li>
</ul>
<h2 id="调用DMBS-MVIEW-REFRESH-ALL-MVIEWS刷新所有的Materialized-View"><a href="#调用DMBS-MVIEW-REFRESH-ALL-MVIEWS刷新所有的Materialized-View" class="headerlink" title="调用DMBS_MVIEW.REFRESH_ALL_MVIEWS刷新所有的Materialized View"></a>调用<code>DMBS_MVIEW.REFRESH_ALL_MVIEWS</code>刷新所有的Materialized View</h2><ul>
<li>这个Procedure 会刷新所有的物化视图，如果其中有未成功刷新的物化视图，会返回失败的次数。</li>
</ul>
<h4 id="Parameter"><a href="#Parameter" class="headerlink" title="Parameter"></a>Parameter</h4><ul>
<li>失败数量，这是一个输出的变量OUT () number_of_failures</li>
<li>刷新方法，F-Fast, P-Fast_PCT, ?-Force, C-Complete</li>
<li>在错误之后是否进行刷新(TRUE or FALSE)。True: 那么需要将 <code>number_of_failure</code> 设置一个失败以后刷新的次数，类似于重新请求。FALSE: 默认Refresh 在遇到第一个错误的时候就会停止，并且列表剩余的物化视图不会刷新。 （refresh_after_errors） 默认为FALSE，</li>
<li>Atomic refresh (TRUE or FALSE) atomic_refresh 默认为TRUE  TRUE: 所有的刷新操作在一个事物中完成. FALSE: 在单独的事务中刷新每个指定的物化视图。<h4 id="For-Example"><a href="#For-Example" class="headerlink" title="For Example"></a>For Example</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DBMS_MVIEW.REFRESH_ALL_MVIEWS(failures,'C','', TRUE, FALSE);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="调用-DMBS-MVIEW-REFRESH-DEPENDENT-刷新那些依赖于特定表或者表列表的物化视图。"><a href="#调用-DMBS-MVIEW-REFRESH-DEPENDENT-刷新那些依赖于特定表或者表列表的物化视图。" class="headerlink" title="调用 DMBS_MVIEW.REFRESH_DEPENDENT 刷新那些依赖于特定表或者表列表的物化视图。"></a>调用 <code>DMBS_MVIEW.REFRESH_DEPENDENT</code> 刷新那些依赖于特定表或者表列表的物化视图。</h2><h4 id="Parameter-1"><a href="#Parameter-1" class="headerlink" title="Parameter"></a>Parameter</h4><ul>
<li>失败数量，这是一个输出的变量OUT (number_of_failures)</li>
<li>相关的表 (list&amp;tab)</li>
<li>刷新方法，F-Fast, P-Fast_PCT, ?-Force, C-Complete  (Method)</li>
<li>使用回滚段 (rollback_seg) 默认为 NULL</li>
<li>在错误之后是否进行刷新(TRUE or FALSE) 同上</li>
<li>Atomic refresh (TRUE or FALSE) atomic_refresh 默认为TRUE 同上</li>
<li>是否嵌套 nested 默认为 FALSE 。 如果是TRUE 会根据依赖项顺序刷新指定表集的所有相关物化视图，以确保物化视图相对于底层基表而言是新鲜的。</li>
</ul>
<h4 id="For-Example-1"><a href="#For-Example-1" class="headerlink" title="For Example"></a>For Example</h4><pre><code><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">    DBMS_MVIEW.REFRESH_DEPENDENT(failures, 'CUSTOMERS', 'C', '', FALSE, FALSE );</span><br><span class="line">    ```  </span><br><span class="line"></span><br><span class="line"># 附录</span><br><span class="line">## 如何确定物化视图是否可以进行快速刷新</span><br><span class="line">  - `DBMS_ADVISOR.TUNE_MVIEW` </span><br><span class="line"></span><br><span class="line">## 监控执行的刷新</span><br><span class="line">  ```sql</span><br><span class="line">  <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> V$SESSION_LONGOPS;</span><br><span class="line">  <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> DBA_JOBS_RUNNING; <span class="comment">--查看那个作业在那个队列上的进度</span></span><br></pre></td></tr></table></figure>
</code></pre><h2 id="检查物化视图的状态"><a href="#检查物化视图的状态" class="headerlink" title="检查物化视图的状态"></a>检查物化视图的状态</h2><p>  oracle提供了3个视图用来检查物化视图的状态.</p>
<ul>
<li>DBA_MVEIWS</li>
<li>ALL_MVIEWS</li>
<li>USER_MVIEWS</li>
</ul>
<h5 id="检查物化视图是新的还是旧的"><a href="#检查物化视图是新的还是旧的" class="headerlink" title="检查物化视图是新的还是旧的"></a>检查物化视图是新的还是旧的</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> MVIEW_NAME, STALENESS, LAST_REFRESH_TYPE, COMPILE_STATE </span><br><span class="line"><span class="keyword">FROM</span> USER_MVIEWS <span class="keyword">ORDER</span> <span class="keyword">BY</span> MVIEW_NAME;</span><br><span class="line"></span><br><span class="line">MVIEW_NAME            STALENESS      LAST_REF       COMPILE_STATE</span><br><span class="line"><span class="comment">----------            ---------      --------       -------------</span></span><br><span class="line">CUST_MTH_SALES_MV     NEEDS_COMPILE  FAST           NEEDS_COMPILE</span><br><span class="line">PROD_YR_SALES_MV      FRESH          FAST           VALID</span><br></pre></td></tr></table></figure>
<p>如果 <code>COMPILE_STATE</code> 是 <code>NEEDS_COMPILE</code> ,那么这条信息的其他列都不准确。</p>
<ul>
<li>要重新将物化视图编译，执行下面语句:<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">MATERIALIZED</span> <span class="keyword">VIEW</span> [materialized_view_name] COMPILE;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="可以使用下面的几个视图来检查分区是否新鲜"><a href="#可以使用下面的几个视图来检查分区是否新鲜" class="headerlink" title="可以使用下面的几个视图来检查分区是否新鲜"></a>可以使用下面的几个视图来检查分区是否新鲜</h5><ul>
<li>USER_MVIEWS 确定物化视图的分区更改跟踪PCT信息</li>
<li>USER_MVIEW_DETAIL_RELATIONS 显示明细表的分区信息。</li>
<li>USER_MVIEW_DETAIL_PARTITION 确定那些分区是新的。</li>
<li>USER_MVIEW_DETAIL_SUBPARTITION 确定那些子分区是新的。</li>
</ul>
<p>下图展示了一个范围列表分区表和一个基于它的物化视图。 </p>
<ul>
<li>分区 P1，P2,P3,P4</li>
<li>子分区 SP1，SP2，SP3<br><img src="./images/1529663932063.png" alt="enter description here"></li>
</ul>
<p>下面是一些用上面的视图来确认MV的是否新鲜</p>
<h5 id="通过USER-MVIEWS-查询视图的PCT信息。"><a href="#通过USER-MVIEWS-查询视图的PCT信息。" class="headerlink" title="通过USER_MVIEWS 查询视图的PCT信息。"></a>通过<code>USER_MVIEWS</code> 查询视图的PCT信息。</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> MVIEW_NAME, NUM_PCT_TABLES, NUM_FRESH_PCT_REGIONS,</span><br><span class="line">   NUM_STALE_PCT_REGIONS</span><br><span class="line"><span class="keyword">FROM</span> USER_MVIEWS</span><br><span class="line"><span class="keyword">WHERE</span> MVIEW_NAME = MV1;</span><br><span class="line"></span><br><span class="line">MVIEW_NAME NUM_PCT_TABLES NUM_FRESH_PCT_REGIONS NUM_STALE_PCT_REGIONS</span><br><span class="line"><span class="comment">---------- -------------- --------------------- ---------------------</span></span><br><span class="line">       MV1              1                     9                     3</span><br></pre></td></tr></table></figure>
<h5 id="通过-USER-MVIEW-DETAIL-RELATIONS-查询视图的PCT信息"><a href="#通过-USER-MVIEW-DETAIL-RELATIONS-查询视图的PCT信息" class="headerlink" title="通过 USER_MVIEW_DETAIL_RELATIONS 查询视图的PCT信息"></a>通过 <code>USER_MVIEW_DETAIL_RELATIONS</code> 查询视图的PCT信息</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> MVIEW_NAME, DETAILOBJ_NAME, DETAILOBJ_PCT,</span><br><span class="line">   NUM_FRESH_PCT_PARTITIONS, NUM_STALE_PCT_PARTITIONS</span><br><span class="line"><span class="keyword">FROM</span> USER_MVIEW_DETAIL_RELATIONS</span><br><span class="line"><span class="keyword">WHERE</span> MVIEW_NAME = MV1;</span><br><span class="line"></span><br><span class="line">MVIEW_NAME  DETAILOBJ_NAME  DETAIL_OBJ_PCT  NUM_FRESH_PCT_PARTITIONS  NUM_STALE_PCT_PARTITIONS</span><br><span class="line"><span class="comment">----------  --------------  --------------  ------------------------  ------------------------</span></span><br><span class="line">        MV1             T1               Y                         3                         1</span><br></pre></td></tr></table></figure>
<h5 id="通过-USER-MVIEW-DETAIL-PARTITION-查询视图的PCT信息"><a href="#通过-USER-MVIEW-DETAIL-PARTITION-查询视图的PCT信息" class="headerlink" title="通过 USER_MVIEW_DETAIL_PARTITION 查询视图的PCT信息"></a>通过 <code>USER_MVIEW_DETAIL_PARTITION</code> 查询视图的PCT信息</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> MVIEW_NAME,DETAILOBJ_NAME,DETAIL_PARTITION_NAME,</span><br><span class="line">   DETAIL_PARTITION_POSITION,FRESHNESS</span><br><span class="line"><span class="keyword">FROM</span> USER_MVIEW_DETAIL_PARTITION</span><br><span class="line"><span class="keyword">WHERE</span> MVIEW_NAME = MV1;</span><br><span class="line"></span><br><span class="line">MVIEW_NAME  DETAILOBJ_NAME  DETAIL_PARTITION_NAME  DETAIL_PARTITION_POSITION  FRESHNESS</span><br><span class="line"><span class="comment">----------  --------------  ---------------------  -------------------------  ---------</span></span><br><span class="line">       MV1               T1                    P1                          1      FRESH</span><br><span class="line">       MV1               T1                    P2                          2      FRESH</span><br><span class="line">       MV1               T1                    P3                          3      STALE</span><br><span class="line">       MV1               T1                    P4                          4      FRESH</span><br></pre></td></tr></table></figure>
<h5 id="通过-USER-MVIEW-DETAIL-SUBPARTITION-查询视图的PCT信息"><a href="#通过-USER-MVIEW-DETAIL-SUBPARTITION-查询视图的PCT信息" class="headerlink" title="通过 USER_MVIEW_DETAIL_SUBPARTITION 查询视图的PCT信息"></a>通过 <code>USER_MVIEW_DETAIL_SUBPARTITION</code> 查询视图的PCT信息</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> MVIEW_NAME,DETAILOBJ_NAME,DETAIL_PARTITION_NAME, DETAIL_SUBPARTITION_NAME,</span><br><span class="line">    DETAIL_SUBPARTITION_POSITION,FRESHNESS</span><br><span class="line"><span class="keyword">FROM</span> USER_MVIEW_DETAIL_SUBPARTITION</span><br><span class="line"><span class="keyword">WHERE</span> MVIEW_NAME = MV1;</span><br><span class="line"></span><br><span class="line">MVIEW_NAME DETAILOBJ DETAIL_PARTITION DETAIL_SUBPARTITION_NAME DETAIL_SUBPARTITION_POS FRESHNESS</span><br><span class="line"><span class="comment">---------- --------- ---------------- ------------------------ ----------------------- ---------</span></span><br><span class="line">       MV1        T1               P1                      SP1                       1     FRESH</span><br><span class="line">       MV1        T1               P1                      SP2                       1     FRESH</span><br><span class="line">       MV1        T1               P1                      SP3                       1     FRESH</span><br><span class="line">       MV1        T1               P2                      SP1                       1     FRESH</span><br><span class="line">       MV1        T1               P2                      SP2                       1     FRESH</span><br><span class="line">       MV1        T1               P2                      SP3                       1     FRESH</span><br><span class="line">       MV1        T1               P3                      SP1                       1     STALE</span><br><span class="line">       MV1        T1               P3                      SP2                       1     STALE</span><br><span class="line">       MV1        T1               P3                      SP3                       1     STALE</span><br><span class="line">       MV1        T1               P4                      SP1                       1     FRESH</span><br><span class="line">       MV1        T1               P4                      SP2                       1     FRESH</span><br><span class="line">       MV1        T1               P4                      SP3                       1     FRESH</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/21/filename/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/21/filename/" itemprop="url">
                  Spark SQL读取hive数据时报找不到mysql驱动
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2018-06-21 15:24:21 / Updated at: 15:36:20" itemprop="dateCreated datePublished" datetime="2018-06-21T15:24:21+08:00">2018-06-21</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Exception"><a href="#Exception" class="headerlink" title="Exception :"></a>Exception :</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">import</span> spark.sql</span><br><span class="line"><span class="keyword">import</span> spark.sql</span><br><span class="line">scala&gt; <span class="keyword">val</span> df = sql(<span class="string">"select * from default.orders"</span>)</span><br><span class="line"><span class="type">Caused</span> by: org.datanucleus.exceptions.<span class="type">NucleusException</span>: <span class="type">Attempt</span> to invoke the <span class="string">"BONECP"</span> plugin to create a <span class="type">ConnectionPool</span> gave an error : <span class="type">The</span> specified datastore driver (<span class="string">"com.mysql.jdbc.Driver"</span>) was not found in the <span class="type">CLASSPATH</span>. <span class="type">Please</span> check your <span class="type">CLASSPATH</span> specification, and the name of the driver.</span><br></pre></td></tr></table></figure>
<h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution :"></a>Solution :</h4><p>1、需要将hive-site.xml 拷贝到spark 的conf 目录下。<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/<span class="built_in">local</span>/src/apache-hive-1.2.2-bin/conf/hive-site.xml /usr/<span class="built_in">local</span>/src/spark-2.0.2-bin-hadoop2.6/conf/</span><br></pre></td></tr></table></figure></p>
<p>2、将对应的mysql-connector-java-5.1.44-bin.jar 放到$SPARK_HOME/jars/目录下。<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/<span class="built_in">local</span>/src/mysql-connector-java-5.1.44/mysql-connector-java-5.1.44-bin.jar /usr/<span class="built_in">local</span>/src/spark-2.0.2-bin-hadoop2.6/jars/</span><br></pre></td></tr></table></figure></p>
<h4 id="Verification-："><a href="#Verification-：" class="headerlink" title="Verification ："></a>Verification ：</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">import</span> spark.sql</span><br><span class="line"><span class="keyword">import</span> spark.sql</span><br><span class="line">scala&gt; <span class="keyword">val</span> orders = sql(<span class="string">"select * from orders"</span>)</span><br><span class="line">orders: org.apache.spark.sql.<span class="type">DataFrame</span> = [order_id: string, user_id: string ... <span class="number">5</span> more fields]</span><br><span class="line"></span><br><span class="line">scala&gt; orders.show(<span class="number">10</span>)</span><br><span class="line">+--------+-------+--------+------------+---------+-----------------+----------------------+</span><br><span class="line">|order_id|user_id|eval_set|order_number|order_dow|order_hour_of_day|days_since_prior_order|</span><br><span class="line">+--------+-------+--------+------------+---------+-----------------+----------------------+</span><br><span class="line">|order_id|user_id|eval_set|order_number|order_dow|order_hour_of_day| days_since_prior_...|</span><br><span class="line">| <span class="number">2539329</span>| <span class="number">1</span>| prior| <span class="number">1</span>| <span class="number">2</span>| <span class="number">08</span>| |</span><br><span class="line">| <span class="number">2398795</span>| <span class="number">1</span>| prior| <span class="number">2</span>| <span class="number">3</span>| <span class="number">07</span>| <span class="number">15.0</span>|</span><br><span class="line">| <span class="number">473747</span>| <span class="number">1</span>| prior| <span class="number">3</span>| <span class="number">3</span>| <span class="number">12</span>| <span class="number">21.0</span>|</span><br><span class="line">| <span class="number">2254736</span>| <span class="number">1</span>| prior| <span class="number">4</span>| <span class="number">4</span>| <span class="number">07</span>| <span class="number">29.0</span>|</span><br><span class="line">| <span class="number">431534</span>| <span class="number">1</span>| prior| <span class="number">5</span>| <span class="number">4</span>| <span class="number">15</span>| <span class="number">28.0</span>|</span><br><span class="line">| <span class="number">3367565</span>| <span class="number">1</span>| prior| <span class="number">6</span>| <span class="number">2</span>| <span class="number">07</span>| <span class="number">19.0</span>|</span><br><span class="line">| <span class="number">550135</span>| <span class="number">1</span>| prior| <span class="number">7</span>| <span class="number">1</span>| <span class="number">09</span>| <span class="number">20.0</span>|</span><br><span class="line">| <span class="number">3108588</span>| <span class="number">1</span>| prior| <span class="number">8</span>| <span class="number">1</span>| <span class="number">14</span>| <span class="number">14.0</span>|</span><br><span class="line">| <span class="number">2295261</span>| <span class="number">1</span>| prior| <span class="number">9</span>| <span class="number">1</span>| <span class="number">16</span>| <span class="number">0.0</span>|</span><br><span class="line">+--------+-------+--------+------------+---------+-----------------+----------------------+</span><br><span class="line">only showing top <span class="number">10</span> rows</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/21/GithubPages-Hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/21/GithubPages-Hexo/" itemprop="url">
                  GithubPages-Hexo
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2018-06-21 14:07:53 / Updated at: 14:10:38" itemprop="dateCreated datePublished" datetime="2018-06-21T14:07:53+08:00">2018-06-21</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Install-Node-js"><a href="#Install-Node-js" class="headerlink" title="Install Node.js"></a>Install Node.js</h1><h1 id="Install-Git"><a href="#Install-Git" class="headerlink" title="Install Git"></a>Install Git</h1><h1 id="Install-Hexo"><a href="#Install-Hexo" class="headerlink" title="Install Hexo"></a>Install Hexo</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> d:/hexo</span><br><span class="line">$ npm install hexo-cli -g</span><br><span class="line">$ hexo init blog</span><br><span class="line">$ <span class="built_in">cd</span> blog</span><br><span class="line">$ npm install</span><br><span class="line">$ hexo g <span class="comment"># 或者hexo generate</span></span><br><span class="line">$ hexo s <span class="comment"># 或者hexo server，可以在http://localhost:4000/ 查看</span></span><br></pre></td></tr></table></figure>
<p>创建对应的Hexo目录。/e/Information_Technology/Github/Hexo</p>
<h4 id="进到Hexo目录下，初始化"><a href="#进到Hexo目录下，初始化" class="headerlink" title="进到Hexo目录下，初始化"></a>进到Hexo目录下，初始化</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Administrator@PC-20180413ATTH MINGW64 /e/Information_Technology/Github/Hexo</span><br><span class="line">$ hexo init</span><br><span class="line">INFO  Cloning hexo-starter to E:\Information_Technology\Github\Hexo</span><br><span class="line">Cloning into &apos;E:\Information_Technology\Github\Hexo&apos;...</span><br><span class="line">remote: Counting objects: 65, done.</span><br><span class="line">remote: Total 65 (delta 0), reused 0 (delta 0), pack-reused 65</span><br><span class="line">Unpacking objects: 100% (65/65), done.</span><br><span class="line">Submodule &apos;themes/landscape&apos; (https://github.com/hexojs/hexo-theme-landscape.git) registered for path &apos;themes/landscape&apos;</span><br><span class="line">Cloning into &apos;E:/Information_Technology/Github/Hexo/themes/landscape&apos;...</span><br><span class="line">remote: Counting objects: 824, done.</span><br><span class="line">remote: Total 824 (delta 0), reused 0 (delta 0), pack-reused 823</span><br><span class="line">Receiving objects: 100% (824/824), 2.54 MiB | 445.00 KiB/s, done.</span><br><span class="line">Resolving deltas: 100% (435/435), done.</span><br><span class="line">Submodule path &apos;themes/landscape&apos;: checked out &apos;73a23c51f8487cfcd7c6deec96ccc7543960d350&apos;</span><br><span class="line">INFO  Install dependencies</span><br><span class="line">npm WARN deprecated titlecase@1.1.2: no longer maintained</span><br><span class="line"></span><br><span class="line">&gt; nunjucks@3.1.3 postinstall E:\Information_Technology\Github\Hexo\node_modules\nunjucks</span><br><span class="line">&gt; node postinstall-build.js src</span><br><span class="line"></span><br><span class="line">npm notice created a lockfile as package-lock.json. You should commit this file.</span><br><span class="line">npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.2.4 (node_modules\fsevents):</span><br><span class="line">npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.2.4: wanted &#123;&quot;os&quot;:&quot;darwin&quot;,&quot;arch&quot;:&quot;any&quot;&#125; (current: &#123;&quot;os&quot;:&quot;win32&quot;,&quot;arch&quot;:&quot;x64&quot;&#125;)</span><br><span class="line"></span><br><span class="line">added 402 packages in 36.807s</span><br><span class="line">INFO  Start blogging with Hexo!</span><br></pre></td></tr></table></figure>
<h4 id="初始化以后的目录结构"><a href="#初始化以后的目录结构" class="headerlink" title="初始化以后的目录结构"></a>初始化以后的目录结构</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Administrator@PC-20180413ATTH MINGW64 /e/Information_Technology/Github/Hexo</span><br><span class="line">$ ll</span><br><span class="line">total 233</span><br><span class="line">-rw-r--r-- 1 Administrator 197121   1846 6月  21 10:44 _config.yml</span><br><span class="line">-rw-r--r-- 1 Administrator 197121    174 6月  21 10:53 db.json</span><br><span class="line">drwxr-xr-x 1 Administrator 197121      0 6月  21 10:45 node_modules/</span><br><span class="line">-rw-r--r-- 1 Administrator 197121    447 6月  21 10:48 package.json</span><br><span class="line">-rw-r--r-- 1 Administrator 197121 126981 6月  21 10:45 package-lock.json</span><br><span class="line">drwxr-xr-x 1 Administrator 197121      0 6月  21 10:44 scaffolds/</span><br><span class="line">drwxr-xr-x 1 Administrator 197121      0 6月  21 10:44 source/</span><br><span class="line">drwxr-xr-x 1 Administrator 197121      0 6月  21 10:44 themes/</span><br></pre></td></tr></table></figure>
<h4 id="初始化以后-可以预览对应的网页"><a href="#初始化以后-可以预览对应的网页" class="headerlink" title="初始化以后 可以预览对应的网页"></a>初始化以后 可以预览对应的网页</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Administrator@PC-20180413ATTH MINGW64 /e/Information_Technology/Github/Hexo</span><br><span class="line">$ hexo  s  <span class="comment">#启动本地的server</span></span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Hexo is running at http://localhost:4000/. Press Ctrl+C to stop.</span><br></pre></td></tr></table></figure>
<ul>
<li>Url :  <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a>  就是本地预览静态网页的地址。</li>
</ul>
<h4 id="创建新的博客文章"><a href="#创建新的博客文章" class="headerlink" title="创建新的博客文章"></a>创建新的博客文章</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Administrator@PC-20180413ATTH MINGW64 /e/Information_Technology/Github/Hexo</span><br><span class="line">$ hexo n &quot;My New Post&quot;</span><br><span class="line">INFO  Created: E:\Information_Technology\Github\Hexo\source\_posts\My-New-Post.md</span><br></pre></td></tr></table></figure>
<ul>
<li>Hexo n  # 相当于 Hexo new 会在 Hexo 的 source/_posts/目录下创建一个新的 .md 文件。</li>
</ul>
<h4 id="生成静态网页文件。"><a href="#生成静态网页文件。" class="headerlink" title="生成静态网页文件。"></a>生成静态网页文件。</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">Administrator@PC-20180413ATTH MINGW64 /e/Information_Technology/Github/Hexo</span><br><span class="line">$ hexo g</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Files loaded <span class="keyword">in</span> 274 ms</span><br><span class="line">INFO  Generated: index.html</span><br><span class="line">INFO  Generated: archives/index.html</span><br><span class="line">INFO  Generated: fancybox/blank.gif</span><br><span class="line">INFO  Generated: fancybox/jquery.fancybox.css</span><br><span class="line">INFO  Generated: fancybox/jquery.fancybox.pack.js</span><br><span class="line">INFO  Generated: fancybox/jquery.fancybox.js</span><br><span class="line">INFO  Generated: fancybox/fancybox_loading.gif</span><br><span class="line">INFO  Generated: fancybox/fancybox_loading@2x.gif</span><br><span class="line">INFO  Generated: fancybox/fancybox_overlay.png</span><br><span class="line">INFO  Generated: fancybox/fancybox_sprite.png</span><br><span class="line">INFO  Generated: fancybox/fancybox_sprite@2x.png</span><br><span class="line">INFO  Generated: archives/2018/06/index.html</span><br><span class="line">INFO  Generated: archives/2018/index.html</span><br><span class="line">INFO  Generated: css/fonts/FontAwesome.otf</span><br><span class="line">INFO  Generated: fancybox/helpers/fancybox_buttons.png</span><br><span class="line">INFO  Generated: css/fonts/fontawesome-webfont.eot</span><br><span class="line">INFO  Generated: js/script.js</span><br><span class="line">INFO  Generated: css/fonts/fontawesome-webfont.woff</span><br><span class="line">INFO  Generated: fancybox/helpers/jquery.fancybox-buttons.css</span><br><span class="line">INFO  Generated: fancybox/helpers/jquery.fancybox-buttons.js</span><br><span class="line">INFO  Generated: fancybox/helpers/jquery.fancybox-media.js</span><br><span class="line">INFO  Generated: fancybox/helpers/jquery.fancybox-thumbs.js</span><br><span class="line">INFO  Generated: css/style.css</span><br><span class="line">INFO  Generated: fancybox/helpers/jquery.fancybox-thumbs.css</span><br><span class="line">INFO  Generated: 2018/06/21/My-New-Post/index.html</span><br><span class="line">INFO  Generated: css/images/banner.jpg</span><br><span class="line">INFO  Generated: css/fonts/fontawesome-webfont.ttf</span><br><span class="line">INFO  Generated: css/fonts/fontawesome-webfont.svg</span><br><span class="line">INFO  Generated: 2018/06/21/hello-world/index.html</span><br><span class="line">INFO  29 files generated <span class="keyword">in</span> 728 ms</span><br></pre></td></tr></table></figure>
<ul>
<li>Hexo g  # 相当于 Hexo generate 使用Hexo 生成静态网页文件，会在 Hexo 目录下新建一个 public目录</li>
<li>对应的public 目录结构<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Administrator@PC-20180413ATTH MINGW64 /e/Information_Technology/Github/Hexo/public</span><br><span class="line">$ ll</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x 1 Administrator 197121    0 6月  21 10:59 2018/</span><br><span class="line">drwxr-xr-x 1 Administrator 197121    0 6月  21 10:59 archives/</span><br><span class="line">drwxr-xr-x 1 Administrator 197121    0 6月  21 10:59 css/</span><br><span class="line">drwxr-xr-x 1 Administrator 197121    0 6月  21 10:59 fancybox/</span><br><span class="line">-rw-r--r-- 1 Administrator 197121 7548 6月  21 10:59 index.html</span><br><span class="line">drwxr-xr-x 1 Administrator 197121    0 6月  21 10:59 js/</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>将生成的静态网页文件deploy 到github 的 repository .</p>
<p>编辑 Hexo 目录下的 _config.yml 文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ pwd</span><br><span class="line">/e/Information_Technology/Github/Hexo</span><br><span class="line">Administrator@PC-20180413ATTH MINGW64 /e/Information_Technology/Github/Hexo</span><br><span class="line">$ vim _config.yml</span><br></pre></td></tr></table></figure></p>
<p>在最下面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Deployment  </span><br><span class="line">## Docs: https://hexo.io/docs/deployment.html</span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: git@github.com:LarsonLL/LarsonLL.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure></p>
<p>执行 Hexo d # 相当于 Hexo deploy 。</p>
<h4 id="Error-Example"><a href="#Error-Example" class="headerlink" title="Error Example"></a>Error Example</h4><ul>
<li><p>ERROR Deployer not found: git</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Administrator@PC-20180413ATTH MINGW64 /e/Information_Technology/Github/Hexo</span><br><span class="line">$ hexo d</span><br><span class="line">ERROR Deployer not found: git</span><br></pre></td></tr></table></figure>
</li>
<li><p>Solution<br>  缺少对应的deploy 插件</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-deployer-git --save</span><br><span class="line">  npm WARN deprecated swig@1.4.2: This package is no longer maintained</span><br><span class="line">  npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.2.4 (node_modules\fsevents):</span><br><span class="line">  npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.2.4: wanted &#123;&quot;os&quot;:&quot;darwin&quot;,&quot;arch&quot;:&quot;any&quot;&#125; (current: &#123;&quot;os&quot;:&quot;win32&quot;,&quot;arch&quot;:&quot;x64&quot;&#125;)</span><br><span class="line">  + hexo-deployer-git@0.3.1</span><br><span class="line">  added 31 packages in 11.48s</span><br></pre></td></tr></table></figure>
</li>
<li><p>Verification</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ hexo d</span><br><span class="line">Branch &apos;master&apos; set up to track remote branch &apos;master&apos; from &apos;git@github.com:LarsonLL/LarsonLL.github.io.git&apos;.</span><br><span class="line">To github.com:LarsonLL/LarsonLL.github.io.git</span><br><span class="line"> + 34a645e...3dc6076 HEAD -&gt; master (forced update)</span><br><span class="line">INFO  Deploy done: git</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="hexo-常用命令"><a href="#hexo-常用命令" class="headerlink" title="hexo 常用命令"></a>hexo 常用命令</h4><ul>
<li>hexo new “postName” #新建文章</li>
<li>hexo new page “pageName” #新建页面</li>
<li>hexo generate #生成静态页面至public目录</li>
<li>hexo server #开启预览访问端口（默认端口4000，’ctrl + c’关闭server）</li>
<li>hexo deploy #将.deploy目录部署到GitHub</li>
<li>简写：</li>
<li>hexo n == hexo newhexo g == hexo generate</li>
<li>hexo s == hexo server</li>
<li>hexo d == hexo deploy</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/21/My-New-Post/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/21/My-New-Post/" itemprop="url">
                  My New Post
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2018-06-21 10:53:45" itemprop="dateCreated datePublished" datetime="2018-06-21T10:53:45+08:00">2018-06-21</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/21/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/21/hello-world/" itemprop="url">
                  Hello World
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2018-06-21 10:44:14" itemprop="dateCreated datePublished" datetime="2018-06-21T10:44:14+08:00">2018-06-21</time>
            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">Artikel</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">4</span>
                    <span class="site-state-item-name">Tags</span>
                  
                </div>
              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  

  
</div>




  <div class="powered-by">Erstellt mit  <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Muse</a> v6.3.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
